<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Docker | 花开自有期，绽放义有时</title><meta name="author" content="titi"><meta name="copyright" content="titi"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="一、基础介绍 镜像docker镜像类似于一个安装包，类比mysql，内部可以有mysql安装依赖部署等，docker可以拉取镜像到本地虚拟机中，并忽略不同操作系统之间的差异，拉取后可以直接使用 容器镜像拉取到本地后，会在本地开辟一个隔离空间来运行，称之为容器，一个镜像可以开辟多个不同的容器，且之间不会有干扰，实现多开效果，注意，一个容器是运行在虚拟机内部，完全隔离外界的，拥有自己的ip地址等，但是">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker">
<meta property="og:url" content="https://titizzz03.github.io/2024/12/30/Docker/index.html">
<meta property="og:site_name" content="花开自有期，绽放义有时">
<meta property="og:description" content="一、基础介绍 镜像docker镜像类似于一个安装包，类比mysql，内部可以有mysql安装依赖部署等，docker可以拉取镜像到本地虚拟机中，并忽略不同操作系统之间的差异，拉取后可以直接使用 容器镜像拉取到本地后，会在本地开辟一个隔离空间来运行，称之为容器，一个镜像可以开辟多个不同的容器，且之间不会有干扰，实现多开效果，注意，一个容器是运行在虚拟机内部，完全隔离外界的，拥有自己的ip地址等，但是">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://titizzz03.github.io/uploads/avatar.jpg">
<meta property="article:published_time" content="2024-12-30T09:17:14.000Z">
<meta property="article:modified_time" content="2024-12-31T06:01:14.114Z">
<meta property="article:author" content="titi">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://titizzz03.github.io/uploads/avatar.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://titizzz03.github.io/2024/12/30/Docker/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Docker',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/uploads/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-handshake-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-id-card"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">花开自有期，绽放义有时</span></a><a class="nav-page-title" href="/"><span class="site-name">Docker</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-handshake-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-id-card"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Docker</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-12-30T09:17:14.000Z" title="发表于 2024-12-30 17:17:14">2024-12-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-12-31T06:01:14.114Z" title="更新于 2024-12-31 14:01:14">2024-12-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux/">Linux</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h3 id="一、基础介绍"><a href="#一、基础介绍" class="headerlink" title="一、基础介绍"></a>一、基础介绍</h3><ul>
<li>镜像<br>docker镜像类似于一个安装包，类比mysql，内部可以有mysql安装依赖部署等，docker可以拉取镜像到本地虚拟机中，并忽略不同操作系统之间的差异，拉取后可以直接使用</li>
<li>容器<br>镜像拉取到本地后，会在本地开辟一个隔离空间来运行，称之为容器，一个镜像可以开辟多个不同的容器，且之间不会有干扰，实现多开效果，注意，一个容器是运行在虚拟机内部，完全隔离外界的，拥有自己的ip地址等，但是无法与外界进行通信，类似自己一个小主机，只能和宿主机实现通信效果</li>
</ul>
<h3 id="二、常见选项和操作"><a href="#二、常见选项和操作" class="headerlink" title="二、常见选项和操作"></a>二、常见选项和操作</h3><blockquote>
<p><strong>常见子选项</strong><br><code>-d</code> 容器在后台运行，不加-d会占用前台<br><code>-name</code> 为容器取名，唯一<br><code>-p [localhost-port]:[docker-port]</code> 设置端口映射，将宿主机的port和docker的内部port做一个端口映射，使其能和外界做通信，一个宿主机的端口只能分配给一个docker做映射，一个docker相当于一个宿主机的进程<br><code>-e [KEY]=[VALUE]</code> 设置环境变量，由镜像决定<br><code>[repository]:[tag]</code> 指定运行的镜像名称和镜像版本，默认最新版，一般加在docker命令尾端</p>
</blockquote>
<blockquote>
<p><strong>镜像相关操作</strong><br><code>docker pull</code> 拉取镜像地址到本地<br><code>docker images</code> 查看本地所有镜像<br><code>docker rmi</code> 删除镜像<br><code>docker file + docker build</code> 创建自定义镜像<br><code>docker save</code> 保存镜像<br><code>docker load</code> 下载镜像<br><code>docker push</code> 上传镜像到镜像仓库</p>
</blockquote>
<blockquote>
<p><strong>容器相关操作</strong><br><code>docker stop</code> 停止容器进程，容器还是存在<br><code>docker start</code> 开启容器进程<br><code>docker run</code> 创建并运行一个容器<br><code>docker ps</code> 查看容器进程<br><code>docker rm</code> 删除容器<br><code>docker logs</code> 查看容器日志<br><code>docker exec</code> 运行容器内部服务</p>
</blockquote>
<h3 id="三、配置服务示例"><a href="#三、配置服务示例" class="headerlink" title="三、配置服务示例"></a>三、配置服务示例</h3><h4 id="1-配置阿里云镜像"><a href="#1-配置阿里云镜像" class="headerlink" title="1. 配置阿里云镜像"></a>1. 配置阿里云镜像</h4><ol>
<li>安装docker依赖包<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# yum install -y yum-utils</span><br><span class="line">[root@localhost ~]# <span class="built_in">sudo</span> yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line">[root@localhost ~]# yum install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</span><br></pre></td></tr></table></figure></li>
<li>查看安装是否成功<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker -v</span><br><span class="line">[root@localhost ~]# systemctl <span class="built_in">enable</span> --now docker</span><br><span class="line">[root@localhost ~]# docker images</span><br></pre></td></tr></table></figure></li>
<li>配置阿里云镜像服务器并重启<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mkdir -p /etc/docker</span><br><span class="line">[root@localhost docker]# vim /etc/docker/daemon.json</span><br><span class="line">&#123; &quot;registry-mirrors&quot;: [ &quot;https://2a6bf1988cb6428c877f723ec7530dbc.mirror.swr.myhuaweicloud.com&quot;, &quot;https://docker.m.daocloud.io&quot;, &quot;https://hub-mirror.c.163.com&quot;, &quot;https://mirror.baidubce.com&quot;, &quot;https://your_preferred_mirror&quot;, &quot;https://dockerhub.icu&quot;, &quot;https://docker.registry.cyou&quot;, &quot;https://docker-cf.registry.cyou&quot;, &quot;https://dockercf.jsdelivr.fyi&quot;, &quot;https://docker.jsdelivr.fyi&quot;, &quot;https://dockertest.jsdelivr.fyi&quot;, &quot;https://mirror.aliyuncs.com&quot;, &quot;https://dockerproxy.com&quot;, &quot;https://mirror.baidubce.com&quot;, &quot;https://docker.m.daocloud.io&quot;, &quot;https://docker.nju.edu.cn&quot;, &quot;https://docker.mirrors.sjtug.sjtu.edu.cn&quot;, &quot;https://docker.mirrors.ustc.edu.cn&quot;, &quot;https://mirror.iscas.ac.cn&quot;, &quot;https://docker.rainbond.cc&quot; ] &#125;</span><br><span class="line">[root@localhost ~]# systemctl daemon-reload</span><br><span class="line">[root@localhost ~]# systemctl restart docker &amp;&amp; systemctl status docker</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="2-配置Nginx环境"><a href="#2-配置Nginx环境" class="headerlink" title="2. 配置Nginx环境"></a>2. 配置Nginx环境</h4><ol>
<li>拉取nginx镜像<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost docker]# docker pull nginx</span><br><span class="line">[root@localhost docker]# docker images</span><br><span class="line">REPOSITORY   TAG       IMAGE ID       CREATED       SIZE</span><br><span class="line">nginx        latest    3b25b682ea82   3 weeks ago   192MB</span><br></pre></td></tr></table></figure></li>
<li>打包nginx镜像(-o output)<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost docker]# docker save -o nginx.tar nginx:latest</span><br><span class="line">[root@localhost docker]# ll</span><br><span class="line">总用量 191248</span><br><span class="line">-rw-r--r-- 1 root root       799 10月 27 06:22 daemon.json</span><br><span class="line">-rw-r--r-- 1 root root        67 10月 27 05:32 daemon.json.bak</span><br><span class="line">-rw------- 1 root root 195826176 10月 27 06:27 nginx.tar</span><br></pre></td></tr></table></figure></li>
<li>删除nginx镜像包，使用tar包进行下载(-i input)<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost docker]# docker rmi nginx:latest</span><br><span class="line">Untagged: nginx:latest</span><br><span class="line">[root@localhost docker]# docker load -i nginx.tar </span><br></pre></td></tr></table></figure></li>
<li>创建并执行一个名为nignx的容器，配置80端口映射，使用nginx镜像包<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost docker]# docker run -d --name nginx -p 80:80 nginx</span><br></pre></td></tr></table></figure></li>
<li>查看正在执行的docker容器进程和所有进程<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost docker]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                   CREATED         STATUS         PORTS                               NAMES</span><br><span class="line">5f8880ea2cff   nginx     &quot;/docker-entrypoint.…&quot;   8 seconds ago   Up 7 seconds   0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp   nginx</span><br><span class="line">[root@localhost docker]# docker ps -a</span><br></pre></td></tr></table></figure></li>
<li>查看nginx容器的日志，-f占用前台追踪日志<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost docker]# docker logs nginx</span><br><span class="line">[root@localhost docker]# docker logs nginx -f</span><br></pre></td></tr></table></figure></li>
<li>进入容器内部，-it(interactive terminal)新开辟终端使用bash解释器<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost docker]# docker exec -it nginx bash</span><br><span class="line">root@5f8880ea2cff:/# ls</span><br><span class="line">bin  boot  dev	docker-entrypoint.d  docker-entrypoint.sh  etc	home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line">root@5f8880ea2cff:/# exit</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="3-配置mysql环境"><a href="#3-配置mysql环境" class="headerlink" title="3. 配置mysql环境"></a>3. 配置mysql环境</h4><ol>
<li>拉取mysql运行镜像，创建并运行一个容器实例对象<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost docker]# docker pull mysql</span><br><span class="line">[root@localhost docker]# docker run -d --name mysql -p 3306:3306 \</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">-e TZ:Asia/Shanghai -e MYSQL_ROOT_PASSWORD=123 mysql</span> </span><br><span class="line">[root@localhost docker]# docker images</span><br><span class="line">REPOSITORY   TAG       IMAGE ID       CREATED       SIZE</span><br><span class="line">mysql        latest    be960704dfac   12 days ago   602MB</span><br><span class="line">nginx        latest    3b25b682ea82   3 weeks ago   192MB</span><br></pre></td></tr></table></figure></li>
<li>进入容器内部<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost docker]# docker exec -it mysql bash</span><br><span class="line">bash-5.1# mysql -uroot -p</span><br><span class="line">Enter password:</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">show databases;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash"><span class="built_in">exit</span></span></span><br><span class="line">bash-5.1# ls</span><br><span class="line">bash-5.1# cat /etc/os-release</span><br><span class="line">PRETTY_NAME=&quot;Oracle Linux Server 9.4&quot;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="四、-数据卷"><a href="#四、-数据卷" class="headerlink" title="四、 数据卷"></a>四、 数据卷</h3><p>已创建已运行的docker容器无法再挂载数据卷，只有在创建容器时边执行挂载数据卷操作，且容器会帮助我们自动创建数据卷，我们只需要执行挂载操作即可，挂载成功后docker服务会将目录自动映射到宿主机下，宿主机下的真实路径也会自动创建</p>
<blockquote>
<p><code>docker volume create</code> 创建数据卷<br><code>docker volume ls</code> 查看数据卷<br><code>docker volume inspect [volume-name]</code>  查看数据卷详细信息<br><code>docker volume rm</code> 删除数据卷<br><code>docker volume prune</code> 清除数据卷数据<br><img src="/images/%E6%95%B0%E6%8D%AE%E5%8D%B71.png"><br> <code>docker run -v [数据卷名称]:[docker内部地址] -d --name [容器名] -p[宿主机port]:[docker-port]</code></p>
</blockquote>
<ol>
<li>删除原有nginx容器<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~] docker rm -f nginx</span><br><span class="line">[root@localhost ~] docker ps    # 确保无nginx进程</span><br></pre></td></tr></table></figure></li>
<li>重新下载nginx容器，下载时创建数据卷<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~] docker run -d --name nginx -p 80:80 -v html:/usr/share/nginx/html nginx</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3f2c8e43875ec9cb78f21b4ff0411af5902755b50ce48280a585738fb2de072b</span></span><br><span class="line">[root@localhost ~] docker volume ls</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">DRIVER    VOLUME NAME</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">local</span>     4fc7e1072ae128b6873bfc940247b0b39d46b64d8bca6d7169d544808d0075dd</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">local</span>     f11e855b8916d5eaf33f7492f3308b64114fbc57e9f795e072c7dcedd1c93520</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">local</span>     html</span></span><br><span class="line">[root@localhost ~] docker volume inspect html</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">[</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">    &#123;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;CreatedAt&quot;</span>: <span class="string">&quot;2024-10-27T17:55:39+08:00&quot;</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Driver&quot;</span>: <span class="string">&quot;local&quot;</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Labels&quot;</span>: null,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Mountpoint&quot;</span>: <span class="string">&quot;/var/lib/docker/volumes/html/_data&quot;</span>,   <span class="comment"># 宿主机真实路径</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;html&quot;</span>,    <span class="comment"># 逻辑卷卷名</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Options&quot;</span>: null,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Scope&quot;</span>: <span class="string">&quot;local&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">    &#125;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">]</span></span><br><span class="line">[root@localhost ~] ls /var/lib/docker/volumes/html/_data</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">50x.html  index.html    <span class="comment"># 文件与容器内部的配置文件相同</span></span></span><br><span class="line">[root@localhost _data] vim index.html</span><br><span class="line">[root@localhost _data] pwd &amp;&amp; cat index.html | grep h1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/var/lib/docker/volumes/html/_data</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">&lt;h1&gt;Welcome to China!&lt;/h1&gt;    <span class="comment"># 修改为China</span></span></span><br></pre></td></tr></table></figure></li>
<li>进入docker容器进行校验<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost _data] docker exec -it nginx bash</span><br><span class="line">root@3f2c8e43875e:/ cd /usr/share/nginx/html</span><br><span class="line">root@3f2c8e43875e:/usr/share/nginx/html cat index.html | grep h1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">&lt;h1&gt;Welcome to China!&lt;/h1&gt;</span></span><br></pre></td></tr></table></figure>
<img src="/images/%E6%95%B0%E6%8D%AE%E5%8D%B72.png"></li>
</ol>
<h3 id="五、本地目录挂载"><a href="#五、本地目录挂载" class="headerlink" title="五、本地目录挂载"></a>五、本地目录挂载</h3><p>mysql容器会自动将容器内部的数据挂载到宿主机上，挂载后数据存储在宿主机，生成匿名卷，卷名称随机生成</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">------ 【自动挂载如下】</span></span><br><span class="line">[root@localhost _data] docker inspect mysql     # 以下就是容器自动挂载点结果</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">&quot;Mounts&quot;</span>: [</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">    &#123;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Type&quot;</span>: <span class="string">&quot;volume&quot;</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Name&quot;</span>:    <span class="string">&quot;4fc7e1072ae128b6873bfc940247b0b39d46b64d8bca6d7169d544808d0075dd&quot;</span>,    <span class="comment"># 容器名称</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Source&quot;</span>: <span class="string">&quot;/var/lib/docker/volumes/4fc7e1072ae128b6873bfc940247b0b39d46b64d8bca6d7169d544808d0075dd/_data&quot;</span>,     // 宿主机挂载地址</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Destination&quot;</span>: <span class="string">&quot;/var/lib/mysql&quot;</span>,    // 容器存储地址</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Driver&quot;</span>: <span class="string">&quot;local&quot;</span>,</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Mode&quot;</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;RW&quot;</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Propagation&quot;</span>: <span class="string">&quot;&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">    &#125;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">],</span></span><br><span class="line">[root@localhost _data] docker volume ls</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">DRIVER    VOLUME NAME</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">local</span>     4fc7e1072ae128b6873bfc940247b0b39d46b64d8bca6d7169d544808d0075dd</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">local</span>     f11e855b8916d5eaf33f7492f3308b64114fbc57e9f795e072c7dcedd1c93520</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">local</span>     html</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">------ 【手动挂载顺序】</span></span><br><span class="line">[root@localhost ~] mkdir /mysql/&#123;data,init,conf&#125; -p</span><br><span class="line">[root@localhost _data] docker run -d --name mysql \</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">-p 3306:3306 \</span></span><br><span class="line"><span class="language-bash">&gt; -e TZ=Asia/Shanghai \     <span class="comment"># [配置环境变量-时间地区]</span></span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">-e MYSQL_ROOT_PASSWORD=cjnn10030406 \    <span class="comment"># [配置mysql中root的密码]</span></span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">-v /root/mysql/data:/var/lib/mysql \    <span class="comment"># [挂载数据]</span></span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">-v /root/mysql/init:/docker-entrypoint-initdb.d \    <span class="comment"># [挂载初始文件]</span></span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">-v /root/mysql/conf:/etc/mysql/conf.d \    <span class="comment"># [挂载配置文件]</span></span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">mysql</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">5c4e6bea23a990338b1c15e08708ae372ef47b21e7e3e71f2e56a91d8e7fc7ae</span></span><br><span class="line">[root@localhost ~] docker inspect mysql   # 挂载详情</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">&quot;Mounts&quot;</span>: [</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">    &#123;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Type&quot;</span>: <span class="string">&quot;bind&quot;</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Source&quot;</span>: <span class="string">&quot;/root/mysql/data&quot;</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Destination&quot;</span>: <span class="string">&quot;/var/lib/mysql&quot;</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Mode&quot;</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;RW&quot;</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Propagation&quot;</span>: <span class="string">&quot;rprivate&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">    &#125;,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">    &#123;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Type&quot;</span>: <span class="string">&quot;bind&quot;</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Source&quot;</span>: <span class="string">&quot;/root/mysql/init&quot;</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Destination&quot;</span>: <span class="string">&quot;/docker-entrypoint-initdb.d&quot;</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Mode&quot;</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;RW&quot;</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Propagation&quot;</span>: <span class="string">&quot;rprivate&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">    &#125;,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">    &#123;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Type&quot;</span>: <span class="string">&quot;bind&quot;</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Source&quot;</span>: <span class="string">&quot;/root/mysql/conf&quot;</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Destination&quot;</span>: <span class="string">&quot;/etc/mysql/conf.d&quot;</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Mode&quot;</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;RW&quot;</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">        <span class="string">&quot;Propagation&quot;</span>: <span class="string">&quot;rprivate&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">    &#125;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">],</span></span><br><span class="line">[root@localhost ~] du -sh mysql    # ls mysql 中可以查看data下已经成功挂载很多文件</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">213M    mysql</span></span><br><span class="line">[root@localhost ~] docker ps -a</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">CONTAINER ID   IMAGE     COMMAND                   CREATED          STATUS          PORTS                                                  NAMES</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">5c4e6bea23a9   mysql     <span class="string">&quot;docker-entrypoint.s…&quot;</span>   15 minutes ago   Up 15 minutes   0.0.0.0:3306-&gt;3306/tcp, :::3306-&gt;3306/tcp, 33060/tcp   mysql</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3f2c8e43875e   nginx     <span class="string">&quot;/docker-entrypoint.…&quot;</span>   3 hours ago      Up 3 hours      0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp                      nginx</span></span><br></pre></td></tr></table></figure>


<h3 id="六、-删除镜像"><a href="#六、-删除镜像" class="headerlink" title="六、 删除镜像"></a>六、 删除镜像</h3><p><strong>删除镜像前，需要将所有镜像创建的容器进行删除，删除成功后最后在删除镜像</strong></p>
<p>显示无法删除，因为 mysql 镜像有容器正在运行中</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-2303010148 ~]# docker rmi mysql:latest</span><br><span class="line">Error response from daemon: conflict: unable to remove repository reference <span class="string">&quot;mysql:latest&quot;</span> (must force) - container 5c4e6bea23a9 is using its referenced image be960704dfac</span><br></pre></td></tr></table></figure>
<p>查看所有正在运行的容器进程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-2303010148 ~]# docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                   CREATED       STATUS                     PORTS                                                  NAMES</span><br><span class="line">817412dd0343   tomcat    <span class="string">&quot;catalina.sh run&quot;</span>         6 weeks ago   Exited (255) 5 weeks ago   0.0.0.0:3355-&gt;8080/tcp, :::3355-&gt;8080/tcp              tomcat01</span><br><span class="line">5c4e6bea23a9   mysql     <span class="string">&quot;docker-entrypoint.s…&quot;</span>   7 weeks ago   Exited (255) 7 weeks ago   0.0.0.0:3306-&gt;3306/tcp, :::3306-&gt;3306/tcp, 33060/tcp   mysql</span><br><span class="line">3f2c8e43875e   nginx     <span class="string">&quot;/docker-entrypoint.…&quot;</span>   7 weeks ago   Exited (255) 7 weeks ago   0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp                      nginx</span><br></pre></td></tr></table></figure>
<p>停止 mysql 镜像运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-2303010148 ~]# docker stop mysql</span><br><span class="line">mysql</span><br></pre></td></tr></table></figure>
<p>删除 mysql 容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-2303010148 ~]# docker <span class="built_in">rm</span> 5c4e6bea23a9</span><br><span class="line">5c4e6bea23a9</span><br></pre></td></tr></table></figure>
<p>再次查看容器进程，删除容器成功，删除容器进程成功</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-2303010148 ~]# docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                   CREATED       STATUS                     PORTS                                       NAMES</span><br><span class="line">817412dd0343   tomcat    <span class="string">&quot;catalina.sh run&quot;</span>         6 weeks ago   Exited (255) 5 weeks ago   0.0.0.0:3355-&gt;8080/tcp, :::3355-&gt;8080/tcp   tomcat01</span><br><span class="line">3f2c8e43875e   nginx     <span class="string">&quot;/docker-entrypoint.…&quot;</span>   7 weeks ago   Exited (255) 7 weeks ago   0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp           nginx</span><br></pre></td></tr></table></figure>
<p>删除镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-2303010148 ~]# docker rmi mysql:latest</span><br></pre></td></tr></table></figure>



<h3 id="七、DockerFile"><a href="#七、DockerFile" class="headerlink" title="七、DockerFile"></a>七、DockerFile</h3><p>是一种定义镜像构建过程的脚本，包含了一系列的命令和指令，可以实现自动化构建 Docker 镜像<br>示例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CentOS with JDK 8</span></span><br><span class="line"><span class="comment"># Author 2303010148</span></span><br><span class="line"><span class="comment"># 指定基础镜像</span></span><br><span class="line">FROM centos</span><br><span class="line"><span class="comment"># 指定作者</span></span><br><span class="line">MAINTAINER 2303010148</span><br><span class="line"><span class="comment"># 新建文件夹用于存放JDK文件</span></span><br><span class="line">RUN <span class="built_in">mkdir</span> /usr/local/java</span><br><span class="line"><span class="comment"># 将JDK文件复制到镜像内并解压</span></span><br><span class="line">ADD jdk-8u151-linux-x64.tar.gz /usr/local/java/</span><br><span class="line"><span class="comment"># 创建软链接</span></span><br><span class="line">RUN <span class="built_in">ln</span> -s /usr/local/java/jdk1.8.0_151 /usr/local/java/jdk</span><br><span class="line"><span class="comment"># 设置环境变量</span></span><br><span class="line">ENV JAVA_HOME /usr/local/java/jdk</span><br><span class="line">ENV JDK_HOME <span class="variable">$&#123;JAVA_HOME&#125;</span>/jre</span><br><span class="line">ENV CLASSPATH .:<span class="variable">$&#123;JAVA_HOME&#125;</span>/lib:<span class="variable">$&#123;JRE_HOME&#125;</span>/lib</span><br><span class="line">ENV PATH <span class="variable">$&#123;JAVA_HOME&#125;</span>/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>


<hr>
<p>不断学习ing，如果有错请指出(⸝⸝•‧̫•⸝⸝)</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://titizzz03.github.io">titi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://titizzz03.github.io/2024/12/30/Docker/">https://titizzz03.github.io/2024/12/30/Docker/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://titizzz03.github.io" target="_blank">花开自有期，绽放义有时</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a></div><div class="post-share"><div class="social-share" data-image="/uploads/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/12/30/Selinux/" title="Selinux"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Selinux</div></div><div class="info-2"><div class="info-item-1">一、定义LINUX传统访问控制标准是DAC自主访问控制，这种情况下进程以一个UID或者一个SUID运行，拥有该角色的权限。而MAC强制访问控制中，策略和安全上下文决定了主体能够访问哪个对象。 二、工作模式Enforcing：强制模式，基于策略规则拒绝主体对目标的访问。Permissive：宽容模式，属于旁观者状态，不会拒绝访问，但是会把信息记录到日志中。Disabled：关闭禁用selinux。 三、工作策略Targeted：默认模式，对大部分网络服务进程进行管理Minimum：对选定的网络服务进行管理Mls：多级高级安全保护 四、配置文件：&#x2F;etc&#x2F;selinux&#x2F;config 五、查询selinux状态sestatus (-v) -v显示详细内容getenforce  六、设置selinux开关 临时开关：setenforce...</div></div></div></a><a class="pagination-related" href="/2024/12/29/hello-world/" title="Hello World"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Hello World</div></div><div class="info-2"><div class="info-item-1">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;  More info: Writing Run server1$ hexo server  More info: Server Generate static files1$ hexo generate  More info: Generating Deploy to remote sites1$ hexo deploy  More info: Deployment </div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2024/12/31/FTP/" title="FTP"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-31</div><div class="info-item-2">FTP</div></div><div class="info-2"><div class="info-item-1">介绍 File Transport File，提供文件上传和下载服务 服务名：vsftpd 端口：21&#x2F;tcp 配置文件：/etc/vsftpd/vsftpd.conf 配置文件常见字段：（1）annoymous_enable &#x3D; YES&#x2F;NO，是否允许匿名用户登录（2）IndexOptions Charset&#x3D;UTF-8，文件编码格式（3）chroot_local_user &#x3D; YES, local_root &#x3D; &#x2F;share，访问根目录 安全上下文策略：ftpd_full_access 防火墙名称：vsftpd   @ 基于 DNS + httpd + ftpd 服务的个人主页发布系统@ shell 脚本批量创建个人主页系统 </div></div></div></a><a class="pagination-related" href="/2024/12/31/Mail/" title="Mail"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-31</div><div class="info-item-2">Mail</div></div><div class="info-2"><div class="info-item-1">  邮件传输代理MTA-Mail Transport Agent，负责将邮件在服务器之间传输。常用协议：SMTP。常见代理商软件：postfix，sendmail，Exim 邮件用户代理MUA-Mail User Agent，负责发送和接收邮件。常用协议：IMAP，POP3，POP3S。常见代理商软件：Dovecot，常见Web端：openwebmail，roundcubemail。 邮件投递代理MDA-Mail Delivery Agent，负责将邮件存储到接收方的邮箱中。  一、Postfix 配置安装 postfix 软件包，对主配置文件 /et/postfix/main.cf 文件进行配置，并重启服务 12345678[titi@localhost ~]$ sudo dnf install -y postfix[titi@localhost ~]$ sudo vim /etc/postfix/main.cfmyhostname = mail.titi.cn    # 主机名mydomain = titi.cn           # 域名myorigin =...</div></div></div></a><a class="pagination-related" href="/2025/01/01/SAMBA/" title="SAMBA"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-01</div><div class="info-item-2">SAMBA</div></div><div class="info-2"><div class="info-item-1">一、安装samba工具1. 确保虚拟机有连接光盘（光盘存放真正软件源，yum包起链接作用）2. 挂载光盘： mount &#x2F;dev&#x2F;sr0 &#x2F;mnt3. 切换目录： cd &#x2F;etc&#x2F;yum.repos.d4. 检查内部是否正常：ls &#x2F;etc&#x2F;yum.repos.d    cat &#x2F;etc&#x2F;yum.repos.d&#x2F;cdrom.repo    yum repolist -v.5. 开始下载： yum install samba -y6. 下载完成： which smbpasswd（查找有无此命令，有即工具已下载） rpm -qa | grep samba（查找有无samba工具） 二、介绍工具名：samba命令名：smbpasswd服务名：smb 三、命令3.1 smbpasswd将 linux 用户添加为 samba 用户：smbpasswd -a username显式添加samba用户：echo -e &quot;123\n123&quot; | smbpasswd -a...</div></div></div></a><a class="pagination-related" href="/2025/01/01/SSH/" title="SSH"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-01</div><div class="info-item-2">SSH</div></div><div class="info-2"><div class="info-item-1">一、介绍：SSH(Secure Shell)是一个网络安全协议，用于多操作系统间的远程登录与服务，相对与Telnet明文传输而言，SSH是对传输内容进行了压缩，后在加密传送，非明文传送，更加安全可靠，提高传输速度 二、配置文件：服务端程序：/usr/bin/sshd，服务端配置文件：/etc/ssh/sshd_config客户端程序：/usr/bin/ssh， 客户端配置文件：/etc/ssh/ssh_config 三、&#x2F;etc&#x2F;ssh&#x2F;sshd_config 主要配置字段：PermitRootLogin no 是否允许root登录PasswordAuthentication yes 是否允许密码登录PubkeyAuthentication yes 是否允许公钥登录AllowUsers，AllowGroups 白名单DenyUsers，DenyGroups...</div></div></div></a><a class="pagination-related" href="/2024/12/30/Selinux/" title="Selinux"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-30</div><div class="info-item-2">Selinux</div></div><div class="info-2"><div class="info-item-1">一、定义LINUX传统访问控制标准是DAC自主访问控制，这种情况下进程以一个UID或者一个SUID运行，拥有该角色的权限。而MAC强制访问控制中，策略和安全上下文决定了主体能够访问哪个对象。 二、工作模式Enforcing：强制模式，基于策略规则拒绝主体对目标的访问。Permissive：宽容模式，属于旁观者状态，不会拒绝访问，但是会把信息记录到日志中。Disabled：关闭禁用selinux。 三、工作策略Targeted：默认模式，对大部分网络服务进程进行管理Minimum：对选定的网络服务进行管理Mls：多级高级安全保护 四、配置文件：&#x2F;etc&#x2F;selinux&#x2F;config 五、查询selinux状态sestatus (-v) -v显示详细内容getenforce  六、设置selinux开关 临时开关：setenforce...</div></div></div></a><a class="pagination-related" href="/2024/12/31/VPN/" title="VPN"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-31</div><div class="info-item-2">VPN</div></div><div class="info-2"><div class="info-item-1">一、 PPTP 协议点对点隧道协议，Point-to-Point Tunneling Protocol，是实现虚拟专用网（VPN）的一种方式。PPTP 使用传输控制协议（TCP）建立控制通道以发送控制命令，并利用通用路由封装（GRE）通道封装点对点协议（PPP）数据包以发送数据。 二、 PPTP 服务2.1 基础信息：下载安装： 123yum install -y ppp wget http://dl.fedoraproject.org/pub/archive/epel/7/x86_64/Packages/p/pptpd-1.4.0-2.el7.x86_64.rpmyum install -y pptpd-1.4.0-2.el7.x86_64.rpm 端口：1723&#x2F;tcp 2.2 防火墙--add-port=1723/tcp，--add-protocol=gre，--add-service=pptp，--zone=trusted --add-interface=ppp+（该命令的作用是将所有以 ppp 开头的接口，例如 ppp0、ppp1 等添加到 trusted...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div class="comment-switch"><span class="first-comment">Valine</span><span id="switch-btn"></span><span class="second-comment">Gitalk</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/uploads/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">titi</div><div class="author-info-description">花开自有期</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Titizzz03"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Titizzz03" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://leetcode.cn/u/thirsty-6aloismqk/" target="_blank" title="LeetCode"><i class="fa fa-bookmark"></i></a><a class="social-icon" href="mailto:3136552132@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://blog.csdn.net/YDxuan?spm=1000.2115.3001.5343" target="_blank" title="CSDN"><i class="fa fa-edit"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog ( ˙˘˙ )</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%9F%BA%E7%A1%80%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">一、基础介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%B8%B8%E8%A7%81%E9%80%89%E9%A1%B9%E5%92%8C%E6%93%8D%E4%BD%9C"><span class="toc-number">2.</span> <span class="toc-text">二、常见选项和操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E9%85%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%A4%BA%E4%BE%8B"><span class="toc-number">3.</span> <span class="toc-text">三、配置服务示例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E9%85%8D%E7%BD%AE%E9%98%BF%E9%87%8C%E4%BA%91%E9%95%9C%E5%83%8F"><span class="toc-number">3.1.</span> <span class="toc-text">1. 配置阿里云镜像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AENginx%E7%8E%AF%E5%A2%83"><span class="toc-number">3.2.</span> <span class="toc-text">2. 配置Nginx环境</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E9%85%8D%E7%BD%AEmysql%E7%8E%AF%E5%A2%83"><span class="toc-number">3.3.</span> <span class="toc-text">3. 配置mysql环境</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81-%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="toc-number">4.</span> <span class="toc-text">四、 数据卷</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%9C%AC%E5%9C%B0%E7%9B%AE%E5%BD%95%E6%8C%82%E8%BD%BD"><span class="toc-number">5.</span> <span class="toc-text">五、本地目录挂载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AD%E3%80%81-%E5%88%A0%E9%99%A4%E9%95%9C%E5%83%8F"><span class="toc-number">6.</span> <span class="toc-text">六、 删除镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%83%E3%80%81DockerFile"><span class="toc-number">7.</span> <span class="toc-text">七、DockerFile</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/04/%E6%97%B6%E9%97%B4%E9%85%8D%E7%BD%AE%E4%B8%8E%E5%90%8C%E6%AD%A5/" title="时间配置与同步">时间配置与同步</a><time datetime="2025-01-04T14:23:24.000Z" title="发表于 2025-01-04 22:23:24">2025-01-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/04/%E6%97%A5%E5%BF%97/" title="日志">日志</a><time datetime="2025-01-04T13:02:18.000Z" title="发表于 2025-01-04 21:02:18">2025-01-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/04/%E9%98%B2%E7%81%AB%E5%A2%99/" title="防火墙">防火墙</a><time datetime="2025-01-04T12:44:28.000Z" title="发表于 2025-01-04 20:44:28">2025-01-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/04/%E6%9D%83%E9%99%90/" title="权限">权限</a><time datetime="2025-01-04T11:20:10.000Z" title="发表于 2025-01-04 19:20:10">2025-01-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/04/%E7%94%A8%E6%88%B7%E5%92%8C%E7%BB%84/" title="用户和组">用户和组</a><time datetime="2025-01-04T11:16:35.000Z" title="发表于 2025-01-04 19:16:35">2025-01-04</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By titi</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const initValine = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyValine = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const valineConfig = {
      el: '#vcomment',
      appId: '',
      appKey: '',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      visitor: false,
      ...option,
      path: isShuoshuo ? path : (option && option.path) || window.location.pathname
    }

    new Valine(valineConfig)
  }

  const loadValine = async (el, path) => {
    if (typeof Valine === 'function') {
      initValine(el, path)
    } else {
      await btf.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js')
      initValine(el, path)
    }
  }

  if (isShuoshuo) {
    'Valine' === 'Valine'
      ? window.shuoshuoComment = { loadComment: loadValine }
      : window.loadOtherComment = loadValine
    return
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  const initGitalk = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyGitalk = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const gitalk = new Gitalk({
      clientID: '',
      clientSecret: '',
      repo: '',
      owner: '',
      admin: [''],
      updateCountCallback: commentCount,
      ...option,
      id: isShuoshuo ? path : (option && option.id) || 'e65fc6fbef208859347a7d4384d74641'
    })

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async(el, path) => {
    if (typeof Gitalk === 'function') initGitalk(el, path)
    else {
      await btf.getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
      await btf.getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js')
      initGitalk(el, path)
    }
  }

  if (isShuoshuo) {
    'Valine' === 'Gitalk'
      ? window.shuoshuoComment = { loadComment: loadGitalk }
      : window.loadOtherComment = loadGitalk
    return
  }

  if ('Valine' === 'Gitalk' || !false) {
    if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>